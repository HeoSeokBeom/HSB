<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Data">
	<typeAlias alias="bbsView" type="com.listen.bbs.vo.BbsVo" />
	<typeAlias alias="bbsLikeSwitchDto" type="com.listen.bbs.dto.BbsLikeSwitchDto" />

	<select id="bbsViewList" resultClass="bbsView" >
		SELECT A.BBS_SEQ, A.BG_IMG_SEQ, A.BBS_CONTENTS, A.BBS_HITCOUNT, A.GOODCOUNT, A.REG_EMAIL, B.PATH, B.SAVE_NAME
		FROM BBS A, BACKGROUND_IMG B
		WHERE A.DISPYN='Y'AND A.BG_IMG_SEQ = B.BG_IMG_SEQ
		ORDER BY A.BBS_SEQ DESC
	</select>
	
	<!-- 공감 버튼 Ajax 처리 Query [ 동적쿼리 사용 ] -->
	<update id="likeCountUpdate" parameterClass="bbsLikeSwitchDto">
		UPDATE BBS SET
		<dynamic>
			<isEqual property="likeSw" compareValue="1"> 
				GOODCOUNT = GOODCOUNT-1
			</isEqual>
		</dynamic>
		<dynamic>
			<isEqual property="likeSw" compareValue="0"> 
				GOODCOUNT = GOODCOUNT+1
			</isEqual>
		</dynamic>
		WHERE BBS_SEQ=#bbs_seq#
	</update>

</sqlMap>
